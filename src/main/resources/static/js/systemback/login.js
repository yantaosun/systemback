var token = $("meta[name='_csrf']").attr("content");var header = $("meta[name='_csrf_header']").attr("content");$(document).ajaxSend(function(e, xhr, options) {    xhr.setRequestHeader(header, token);});$(document).ready(function () {    var username = $("input[name='username']").val();    var password = $("input[name='password']").val();    if(username != '' && password != ''){{        login(username,password);    }}})$(".btn-primary").click(function () {    $.each($("input[name='remember-me-checkbox']:checked"),function () {        $("input[name='remember-me']").val(true);    })    var username = $("input[name='username']").val();    var password = $("input[name='password']").val();    if(username == '' || password == ''){{        layer.msg('请完善信息', {icon: 5});        return;    }}    $.ajax({        type: "GET",        url: "/v5/info",        success: function(data){            console.log(data);             var v5=new com.strato.Verify5({                ssl:true,                host:data.host,                token:data.token,                trustLevel:5            });            v5.on("CANCEL",function(){                //当用户取消验证时触发                layer.msg('取消验证', {icon: 5});            });            v5.verify(function(result){                var success=result.success;                if(success){                    var verifyId=result.verifyId;                    this.login(username,password);                }            });        },        fail:function(data){            layer.msg('验证初始化失败', {icon: 5});        }    });});function login(username,password) {    console.log($("#loginform").serialize());    $.ajax({        url: '/login',        type: 'POST',        data: $("#loginform").serialize(),        success: function (result, status) {            console.log("success res:{} ,status:{}",result,status);            if (result.code == 200) {                layer.msg('登录成功', {                    icon: 1,                    time: 2000                }, function(){                    window.location.href = '/';                });            } else {                layer.msg(result.data, {icon: 1});            }        },        error: function (result, status) {            console.log("error res:{}",result);        }    });}function wb() {    var redirect_uri = "http://127.0.0.1:8884/login/callback/weibo";    window.location.href="https://api.weibo.com/oauth2/authorize?client_id=3271903632&scope=all&redirect_uri="+encodeURI(redirect_uri);}function github() {    var redirect_uri = "http://127.0.0.1:8884/login/callback/weibo";    window.location.href="https://github.com/login/oauth/authorize?client_id=7c68c5adec251f6b23da&scope=user";}function qq() {    var redirect_uri = "http://127.0.0.1:8886/login/callback/weibo";    window.location.href="https://api.weibo.com/oauth2/authorize?client_id=3271903632&redirect_uri="+encodeURI(redirect_uri);}